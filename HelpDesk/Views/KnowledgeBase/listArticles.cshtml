
@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer localizer
@model Entities.Entities.Article

@{ Layout = "~/Views/Shared/_AdminLayout.cshtml";}


<script>

    $(function () {
        var placeholder = $('#placeholder');
        $('a[data-toggle="deleteArticle"]').click(function (event) {

            var url = $(this).data('url');
            $.get(url).done(function (data) {
                placeholder.html(data);
                placeholder.find('.modal').modal('show');
            })


        })

    })

    $(function () {
        var placeholder = $('#placeholder');
        $('a[data-toggle="infoArticle"]').click(function (event) {

            var url = $(this).data('url');
            $.get(url).done(function (data) {
                placeholder.html(data);
                placeholder.find('.modal').modal('show');
            })


        })

    })
</script>

<div id="placeholder"></div>


@if (ViewBag.Message != null)
{

    <script type="text/javascript">
        $("#success-alert").fadeTo(2000, 500).slideUp(500, function () {
            $("#success-alert").slideUp(500);
        });
        $("#danger-alert").fadeTo(2000, 500).slideUp(500, function () {
            $("#danger-alert").slideUp(500);
        });

    </script>

    if (ViewBag.Message.statusOp == true)
    {
        <div class="alert alert-success" id="success-alert">
            <button type="button" class="close" data-dismiss="alert">x</button>
            <strong>@localizer["Success!"]</strong>
            @ViewBag.Message.message
        </div>
    }
    else
    {
        <div class="alert alert-danger" id="danger-alert">
            <button type="button" class="close" data-dismiss="alert">x</button>
            <strong>@localizer["Danger!"]</strong>
            @ViewBag.Message.message
        </div>
    }

}

<div class="card-header">

    <div style="display: flex;justify-content: space-between;align-items:center;">
        <div>
            <span onclick="history.back(-1)" style="cursor:pointer;"><i class="fas fa-long-arrow-alt-left"></i>&nbsp;&nbsp;</span>

            <i class="fas fa-table mr-1"></i>
            @localizer["Articles"]
        </div>
        <a class="btn btn-primary" asp-action="addArticle" asp-controller="KnowledgeBase"
           style="margin-right: 5%;">
            <i class="fas fa-plus"></i>&nbsp; @localizer["addnewarticle"];
        </a>
    </div>
</div>
<div class="card-body">
    <div class="dx-isotope-container">


        <div class="dx-box bg-white ">
            <div class="container">
                <ul class="dx-links dx-isotope-filter text-center p-10" style="background-color: gainsboro;margin:0px -24px;">
                    <li class="active" data-filter="*">@localizer["AllItems"]</li>
                    @foreach (var item in ViewBag.Categories)
                    {
                        <li data-filter=".@item.categoryName">@item.categoryName</li>
                    }



                </ul>
            </div>
        </div>
        <div class="dx-separator"></div>


        <div class="dx-box-5 pb-100 bg-grey-6">
            <div class="container">



                <div class="row vertical-gap dx-isotope-grid">
                    <div class="card-deck">
                        @foreach (var item in ViewBag.Articles)
                        {

                            <div class="dx-isotope-grid-item @item.articleCategory.categoryName">


                                <div class="card border-dark mb-3" style="width:18rem;">

                                    <a href="#" data-toggle="infoArticle" data-target="#infoArticle"
                                       data-url="@Url.Action("infoArticle","KnowledgeBase",new { idArticle = item.ArticleId })"
                                       class="nav-link">
                                        <div class="card-header">

                                            <h5 class="card-title  text-center">@item.Title </h5>
                                            <h6 class="card-subtitle mb-2 text-muted"> @item.articleCategory.categoryName</h6>
                                        </div>
                                        <div class="card-body">
                                            <p style="color:black;" class="card-text">@item.content</p>
                                            <p class="card-text"><small class="text-muted">@localizer["Lastupdated"] @item.lastModified</small></p>

                                        </div>
                                    </a>

                                    <div class="card-footer text-center">
                                        <a asp-action="updateArticle" asp-controller="KnowledgeBase" asp-route-Id="@item.ArticleId" class="card-link"><i class="far fa-edit"></i>&nbsp;@localizer["Edit"]</a>
                                        <a style="color:red;"
                                           href="#" data-toggle="deleteArticle" data-target="#deleteArticle"
                                           data-url="@Url.Action("deleteArticle","KnowledgeBase",new { articleId = item.ArticleId })"
                                           class="card-link">
                                            <i class="fas fa-trash-alt"></i>
                                            &nbsp;@localizer["Delete"]
                                        </a>
                                    </div>

                                </div>

                            </div>

                        }

                    </div>

                </div>



            </div>
        </div>
    </div>
</div>